services:
  cache:
    image: redis:alpine
    container_name: cache
    restart: always
    command: redis-server
  upload-server:
    command: go test -coverprofile=c.out -coverpkg=./... ./... -tags=integration
    environment:
      - AZURITE_STORAGE_KEY=${AZURITE_STORAGE_KEY}
    depends_on:
      - minio
      - azurite
      - cache
